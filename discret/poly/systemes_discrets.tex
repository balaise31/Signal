\chapter{Systèmes discrets}


L'analogie avec les systèmes continus est forte, nous étudions de-même
le cas des systèmes discrets linéaires invariants dans le temps avec
une vision par opérateurs.


\section{Systèmes linéaires}

\begin{definition}{Système SISO (Single Input Single Output)}
  
  Un système discret SISO (resp. continu SISO) relie à un signal d'entrée $x$
  un signal de sortie unique $y$. Les signaux $x$ et $y$ sont des
  fonctions de la variables réelle discrète $k$ (resp. $t$) appartenant
  à un espace de fonction le plus général possible noté ici $L_E$.

  La relation entrée-sortie est donc modélisée par une application
  mathématique de $L_E$ dans $L_E$ notée $L$ (resp. $L_c$ en continu)
  et définie ainsi~:
  \begin{eqnarray}
    L : \qquad \application{L_E}{L_E}{x : \; k\mapsto x\b{k}\quad{}}{\quad y :\; k\mapsto y\b{k}} \\
    L_c: \qquad \application{L_E}{L_E}{x : \; t\mapsto x\p{t}\quad{}}{\quad y :\; t\mapsto y\p{t}} 
    % DONE : correction TYPAGE et remarque notation
  \end{eqnarray}
\end{definition}

Une classe de système fondamentale est la classe des systèmes
linéaires car elle offre de nombreux outils et propriétés
mathématiques.

\begin{definition}{Système linéaire}
  \label{def:linearite}
  
  Une système est dit linéaire si, et seulement si, l'application $L$
  associée est linéaire, soit pour tout
  $\p{x_1,x_2,\lambda} \in L_E^2 \times \R$~:
  \begin{eqnarray}
    \label{eq:def_linearite}
    \forall t \in \R \qquad L\b{x_1 + \lambda\, x_2}(t) = L\b{x_1}(t) + \lambda\,L\b{y_2}(t) \nonumber\\
    \iff \qquad L\b{x_1 + \lambda\,x_2} = L\b{x_1} +\lambda L\b{x_2 }
  \end{eqnarray}
\end{definition}

Une des conséquences de la linéarité est la possibilité d'appliquer le
principe de superposition cher à l'électronicienne~: \og{} la réponse
du système à une combinaison linéaire d'entrées est la combinaison des
réponses de chaque entrée.\fg{}

\begin{definition}{Systèmes continus élémentaires}
  \label{def:systeme_elementaires_continus}
  
Les trois systèmes linéaires élémentaires que nous considérons dans
l'étude des systèmes linéaires continus sont :
\begin{description}
\item[le gain $a.x$]~: $t \mapsto a\,x\p{t}$ où a est une constante
  scalaire réelle ou complexe
\item[le dérivateur $\oder\b{x}=\oder\circ x$]~: $ t \mapsto \dDtDe{x}\p{t} $
\item[l'intégrateur $\oint\b{x}=\oint\circ x$]~: $ t \mapsto \integ{0}{t}{x\p{\nu}\derivDe{\nu}}$ 
\end{description}
\end{definition}

On peut aisément vérifier que ces systèmes respectent la condition de
linéarité~\ref{eq:def_linearite}.

\begin{remarque}
  De manière implicite, on choisi un espace de fonction $L_c$ qui est
  stable par toute combinaison de compositions de ces opérateurs (même
  une infinité de composition de $\oder$ par exemple) soit un espace
  complet de fonctions.

  On aimerait que les opérateurs dérivateur $\oder$ et intégrale
  $\oint$ commutent et soient réciproque sur $L_c$~:
  $\oder\circ\oint=\oint\circ\oder=\Id$. De manière à obtenir une
  composition de ces opérateurs qui ait la même propriété qu'un
  produit algébrique inversible.
  
  Pour que cela soit vrai même avec les fonctions discontinues, il
  faut introduire les distributions de \Dirac{} voir
  \chapref{sec:deriv_discontinues}.
\end{remarque}

\begin{definition}{Systèmes élémentaires discrets}
  
Dans le cas des systèmes discret, les systèmes élémentaires sont :
\begin{description}
\item[le gain $a.x$]~: $ k \mapsto a\,x\b{k}$ où a est une constante
  scalaire réelle ou complexe
\item[le retard unité $\oret\b{x}=\oret\circ x$]~: $ k \mapsto x\b{k-1}$.
\item[l'avance unité $\oavance\b{x}=\oavance\circ x$]~: $ k \mapsto x\b{k+1} $ 
\end{description}
\end{definition}

On peut aisément vérifier que ces systèmes respectent la condition de
linéarité~\ref{eq:def_linearite}.

\begin{remarque}
  La commutation et réciprocité des opérateurs retard $\oret$ et
  avance $\oavance$ est évidente et ne pose pas de problème théorique,
  contrairement au cas continus~:
  $\oret\circ\oavance=\oavance\circ\oret=\Id$.

  La composition~$\circ$ de ces opérateurs avec l'opérateur somme de
  systèmes $+$ a donc une structure d'anneau commutatif~: $\circ$ et
  $+$ des systèmes se comporte comme $\times$ et $+$ des nombres
  réels.

  L'espace des signaux $L_e$ (ou des suites complexes) est stable et
  complet par l'application des opérateurs élémentaires.
\end{remarque}

L'opérateur dérivée n'as pas de sens en discret car la limite
$s'(x)=\lim\limits_{h\to 0} \frac{s(x+h)-s(x)}{h}$ n'aurait pas de
sens pour $h$ entier. On peut s'approcher de cet opérateur avec des
combinasons plus ou moins complexes et précises des opérateusr avance et
retard élémentaires.

\begin{exemple}
  \label{exemple:differentiateur_lineaire}
  L'effet du système \emph{différentiateur} sur le signal d'entrée est d'écrit par
  l'opérateur ~: $$L : x \mapsto y=\frac{x-\oret\b{x}}{T_e}$$
  
  Vérifions d'abord que cet opérateur est linéaire~:
  \begin{eqnarray*}
    L\b{x_1+\lambda x_2}\b{k} &= L\b{x_1+\lambda x_2}\b{k}\\
                              &= \frac{x_1\b{k}+\lambda x_2\b{k} - \oret\b{x_1+\lambda x_2}\b{k}}{T_e}\\
                              &= \frac{x_1\b{k}+\lambda x_2\b{k} - \p{x_1\b{k-1}+\lambda x_2\b{k-1}}}{T_e} = A\\
    L\b{x_{1}}\b{k}+\lambda\,L\b{x_{2}}\b{k}  &= \frac{x_1\b{k} - x_1\b{k-1}}{T_e}+\lambda\,\frac{x_2\b{k} - x_2\b{k-1}}{T_e}=A
  \end{eqnarray*}
  Le système est donc linéaire.
\end{exemple}


% \begin{remarque}
%   Pour résoudre les complexes équations différentielles des
%   télégraphistes, \Heaviside{} utilise ces opérateurs de base et
%   introduit le \emph{calcul opérationnel}. Cela consiste à représenter
%   l'application de l'opérateur dérivée sur une fonction $f$ comme une
%   simple multiplication par un nombre $p$. Ainsi une équation
%   différentielle $a\,y'' + 2y' -y = 3\int x$ est associée à l'équation
%   symbolique $a\,p^2\,y + 2\,p\,y - y = \frac{3}{p}x$. Il est alors
%   possible de résoudre algébriquement l'équation sous forme de
%   fractions rationnelles ce qui donnerait avec notre exemple~:
%   $y = \frac{3/p}{a\,p^2+2p+1} x$. Rappelons que $x$ et $y$ sont des
%   fonctions et non des réels et que dans ce cas les opérations ne sont
%   pas de simple multiplication et addition de réels mais bien des
%   multiplications et additions de fonctions. La variable symbolique
%   $p$ est utilisée comme un nombre réel mais n'est en aucun cas un
%   réel...
% \end{remarque}

\section{Systèmes invariants}
Il est fréquent, et surtout théoriquement utile, qu'un système
réagisse de la même manière indépendemment de l'instant où est
appliqué le signal d'entrée. Ce qui conduit à la définition suivante~:
\begin{definition}{Système invariant dans le temps}
  Un système discrète (resp. continu) est dit invariant dans le temps si et seulement
  si son application associée $L$ (resp. $L_c$) vérifie~:
  \begin{eqnarray}
    \forall x\in L_E, \forall (k,k_0)\in \N^2, \quads L[k\mapsto x(k-k_{0})] = L[x](k-k_{0}) \\
    \forall x\in L_E, \forall (t,t_0)\in \R^2, \quads L_c[t\mapsto x(t-t_{0})] = L[x](t-t_{0}) 
  \end{eqnarray}
  
  En terme d'opérateur~;  un système $L$ est invariant dans
  le temps si, et seulement si, son opérateur commute avec  tout opérateur
  retard de $k_0$ noté $\oretDe{k_0}=\oret^{k_0}\b{x}= k\mapsto x\b{k-k_0}$~:
  \begin{eqnarray}
    \label{eq:sys_invariant}
    L\circ\oretDe{k_0} \; = \; \oretDe{k_0}\circ L  \qquad \iff \qquad  L\b{\oretDe{k_0}\b{x}} = \oretDe{k_0}\b{L\b{x}}
    \\
    L_c\circ\oretDe{\tau} \; = \; \oretDe{\tau}\circ L_c  \qquad \iff \qquad  L_c\b{\oretDe{\tau}\b{x}} = \oretDe{\tau}\b{L_c\b{x}}
  \end{eqnarray}
\end{definition}

Autrement dit \og{}la réponse du système à un signal retardé est le
retard de la réponse du système.\fg{}~; ou encore \og{} la réponse du
système ne dépend pas de l'origine des temps choisie.\fg{}


%% TODO lien vers causalité.

\begin{remarque}
  Il est facile de vérifier que les systèmes discrets élémentaires que
  sont le gain~; le retard unitaire et l'avance unitaire (gain,
  dérivateur et intégrateur pour le continu) sont invariants.  Il en
  est de même pour tout système constitué de combinaisons linéaires
  et de composition de systèmes élémentaires.
  
  Il suffit alors de montrer que le système se décompose avec des
  \emph{coefficients constants} avec des systèmes élémentaires en le
  mettant sous forme \emph{d'équation aux différences} ou
  \emph{récurrence} à coefficients constants (\emph{equations
    différentielle} en continu) ou en un schéma bloc à coefficients
  constant.
\end{remarque}


\section{Réponse d'un système LTI}
Rappelons qu'un système peut aussi bien représenter un correcteur dans
une boucle d'asservissement, qu'un filtre utilisé en boucle ouverte,
ou bien un modèle de système à commander ou observer~: calculer la
réponse d'un système à un signal c'est aussi  \og{}faire du
filtrage.\fg{}

Nous allons d'abord montrer que l'opération de filtrage consiste en
temporel à effectuer une convolution du signal d'entrée $x$ avec la
réponse impulsionnelle $h$ du système $H$ ainsi défini.

En un second temps nous utiliserons la réponse impulsionnelle pour
caractériser la propriété de stabilité du système.

Nous terminerons en montrant que l'opération duale du filtrage
temporel est un \emph{fenêtrage fréquentiel} ou multiplication par la
transformée de la réponse impulsionnelle $\TZ\p{h}=\TZlui{H}$.

\subsection{Réponse impulsionnelle}
Dans le cas discret, l'obtention de la réponse d'un système est facile
à obtenir en utilisant les propriétés LTI du système $H$ et en
décomposant le signal d'entrée $x$ dans la base temporelle canonique.


Contrairement au cas continu, un signal d'entrée quelconque $x$ se
décompose facilement en impulsions unité. La
\figref{fig:reponse_convolution} reprend la décomposition en
impulsions d'un signal d'entrée nommé $s$
\eqref{eq:decomposition_unite} et applique un système $H$ de réponse
impulsionnelle $h$ à chaque impulsion pour obtenir la réponse $y$ du
système. On retrouve ainsi la formule de convolution temporelle de
$y=s\conv h$. Le résultat est démontré dans l'équation
\eqref{eq:reponse_convolution} en utilisant les propriétés de
linéarité et invariance du système.

\begin{figure}[ht!]
  \centering \graphe{0.9\textwidth}{reponse_convolution}
  \caption{La réponse d'un système linéaire invariant $y$ est la somme
    des réponses impulsionnelles des impulsions qui composent le
    signal d'entrée $s$.}
  \label{fig:reponse_convolution}
\end{figure}

\begin{align}
  \label{eq:reponse_convolution}
  \caCest{x = \somme{j=-\infty}{\infty}{x\b{j}\delta_{j}}}{\text{signal}}\quad \implies\quad &y=H\b{x}=H\b{\somme{j=-\infty}{\infty}{x\b{j}\delta_{j}}} \nonumber\\
  \underset{\text{linéarité de H}}{\implies}\quad &y=\somme{j=-\infty}{\infty}{H\b{ \;\caCest{x\!\!\b{j}}{\text{constante !}}\delta_{j}\;}} \underset{\text{linéarite de H}}{=} \;\;\somme{j=-\infty}{\infty}{x\!\b{j}\caCest{H\b{\delta_j}}{H.\oret^j\b{\delta_0}}} \nonumber \\
  \implies \quad &y=\somme{j=-\infty}{\infty}{x\b{j}.H\compo\oret^j\!\b{\delta_{0}}} \underset{\text{invariance de H}}{=} \;\;\somme{j=-\infty}{\infty}{x\b{j}.\oret^j\compo\caCest{H\b{\delta_{0}}}{h}}\nonumber\\
  \implies \quad & y= \somme{j=-\infty}{\infty}{x\b{j}.\caCest{\oret^j\b{h}}{k\mapsto h\b{k-j}}}=x\conv h \nonumber\\
  \implies \quad & \forall k\in\Z,\quad  y\b{k}= \somme{j=-\infty}{\infty}{x\b{j}\,h\!\b{k-j}} = x\conv h\b{k}
\end{align}
où l'opérateur $\conv$ est la convolution discrète définie ci-après.

\begin{definition}{Convolution discrète}
  \label{def:convolution_discrete}
  
  La convolution de signaux discret $u$ et $v$ notée $u\conv v$ est le
  signal discret défini par~:
  \begin{align}
    \label{eq:convolution_discrete}
    &u\conv v \quad &:& \quad k \mapsto u\conv v\b{k} =\somme{j=-\infty}{\infty}{u\ded{j}.v\ded{k-j}} &\underset{j\leftrightarrow j+k}{=}&  \somme{j=-\infty}{\infty}{u\ded{j+k}.v\ded{-j}} \nonumber\\
    &u\conv v \quad & = &\quad\scald{u}{\caCest{\conj{\oret^k.\,\Sy\ded{v}}}{\conj{j\mapsto v\ded{k-j}}}} &=& \scald{\oret^{-k}\ded{u}}{\conj{\Sy\ded{v}}} 
  \end{align}
  où $\oret^k$ est le retard de $k$ échantillons et
  $\oret^{-k}=\oavance^k$ son opérateur réciproque (inverse
  algébrique)~: l'avance de $k$ échantillons.
\end{definition}

\begin{remarque}
  \textbf{Attention à l'ordre des opérations~: la symétrie et le
    retard ne commutent pas~!}

  Même si nous avons vu dans \secref{sec:dualite} que les opérateurs
  $\Sy$ et $\F$ commutent~: $\F\circ\Sy=\Sy\circ\F=\Finv$, il n'en est
  pas de même pour les opérateurs $\Sy$ et $\oret$~!

  Prendre un signal $s$ de la variable discrète $j$, l'avancer de $k$
  échantillons avec $\oavance^k=\oret^{-k}$ puis le retourner avec
  $\Sy$ donne
  $$\caCest{\Sy\;\circ}{\text{Symétrie de }}\;\caCest{\oret^{-k}}{\text{avance }\oavance^k}\b{s} = \Sy\b{\caCest{\oret^{-k}\b{s}}{j\mapsto s\ded{j+k}}}\,: j\mapsto s\ded{\caCest{\p{-j}}{\text{symétrie}}+k}=s\ded{k-j}$$

  Alors que prendre un signal, le retourner avec $\Sy$ puis l'avancer
  avec $\oret^{-k}$ donne
  $$\caCest{\oret^{-k}\;\circ}{\text{Avance }\oavance^k\text{ de }}\;\caCest{\Sy}{\text{symétrie}}\b{s}= \oret^{-k}\b{\caCest{\Sy\b{s}}{j\mapsto s\ded{-j}}}\,: j\mapsto s
  \ded{-\caCest{\p{j+k}}{\text{avance}}}=s\ded{-j-k}$$

  On remarque donc que $\oret^{-k}\circ\Sy\neq\Sy\circ\oret^{-k}$. En
  revanche prendre un signal, le retourner avec $\Sy$ puis le \emph{retarder}
  avec $\oret^{k}$ donne
  $$\caCest{\oret^{k}\;\circ}{\text{Retard de }}\;\caCest{\Sy}{\text{symétrie}}\b{s}= \oret^{k}\b{\caCest{\Sy\b{s}}{j\mapsto s\ded{-j}}}\,: j\mapsto s\ded{-\p{j-k}}=s\ded{k-j}$$

  Donc la commutation donne $\Sy\circ\oret^{-k}=\oret^{k}\circ\Sy$,
  autrement dit soit~:

\emph{  \og{} La symétrie de l'avance d'un signal est le retard de son
  symétrique\fg.}
\end{remarque}

L'analogie avec la convolution de signaux continu $u$ et $v$ notée
$u\conv v$ fonctionne aussi en utilisant le produit scalaire continu
$\scald{u}{\conj{\oret^k.\Sy\b{v}}}$ au lieu du produit scalaire discret.

\begin{definition}{Convolution continue}
  \begin{align}
    \label{eq:convolution_continue}
    &u\conv v \quad &:& \quad  t \;\mapsto\; u\conv v\de{t} =\integ{x=-\infty}{\infty}{u\de{x}.v\de{t-x}\dx} &=& \integ{t=-\infty}{\infty}{u\de{x+t}.v\de{-x}\dx} \nonumber\\
    &u\conv v & = & \quad \scal{u}{\conj{\oret^k\Sy\b{v}}} &=& \quad\scal{\oret^{-k}\b{u}}{\conj{\Sy\b{v}}} 
  \end{align}
\end{definition}


\section{Stabilité d'un système LTI}

\section{Calcul opérationnel}
\subsection{Dualité entre signal et système}
\subsection{Systèmes élémentaires : fonction de transfert en Z }
\subsection{Système non-bouclé -- moyenne glissante -- régressif --  FIR  }
\subsection{Système bouclé -- récurrence -- autorégressif -- IIR}

\section{Transformée en Z}

\subsection{Fonction de transfert et récurrence}
\subsection{Signaux/systèmes usuels}
\subsection{Décomposition élementaire et stabilité}
\subsection{Domaine de convergence et causalité}

\section{Réponse fréquentielle}
\subsection{Lien avec les transformées de Fourier}
\subsection{Dualité entre système et filtre}




%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:

